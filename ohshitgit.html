<!DOCTYPE HTML>
<html>
    <head>
    	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    	<meta name="viewport" content="width=device-width" />
    	<title>Oh, shit, git!</title>
    	<meta name="lolz" content="My git site brings all the mansplainers to the yard." />
        <link href="https://fonts.googleapis.com/css?family=Montserrat|Source+Sans+Pro" rel="stylesheet">
        <style>
            body {
                font-family: 'Source Sans Pro', sans-serif;
                color: #222;
                line-height: 1.5;
            }
            h1, h2, h3, h4, h5, h6 {
                font-family: 'Montserrat', serif;
            }
            h1 {
                line-height: 1.2;
                font-size: 3em;
            }
            .max-width {
                margin: 1em;
            }
            @media screen and (min-width: 46em) {
                .max-width {
                    margin: 0 auto;
                    max-width: 44em;
                }
            }
            .centered {
                text-align: center;
            }
            .spaced {
                margin: 2em 0;
            }
            .no-bottom-margin {
            	margin-bottom: 0;
            }
            .top-lined {
                padding-top: 2em;
                border-top: 1px solid #000;
            }
            .bottom-lined {
                padding-bottom: 2em;
                border-bottom: 1px solid #000;
            }
            .permalinked {
                color: #222;
                text-decoration: none;
            }
            .permalinked:hover,
            .permalinked:focus {
                text-decoration: underline;
            }
            .flattr-note {
            	vertical-align: top;
            }
        </style>
        <link rel="stylesheet" href="/prism.css">
        <link rel="icon" type="image/png" href="favicon-32x32.png" sizes="32x32" />
	<link rel="icon" type="image/png" href="favicon-16x16.png" sizes="16x16" />
	<script>
	  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

	  ga('create', 'UA-8206228-2', 'auto');
	  ga('send', 'pageview');
	</script>
    </head>
    <body class="max-width">
        <header class="bottom-lined spaced">
            <h1 class="centered">Oh shit, git!</h1>
            <p>Git is hard: screwing up is easy, and figuring out how to fix your mistakes is fucking impossible. Git documentation has this chicken and egg problem where you can't search for how to get yourself out of a mess, unless you <em>already know the name of the thing you need to know about</em> in order to fix your problem.</p>
            <p>So here are some bad situations I've gotten myself into, and how I eventually got myself out of them <i>in plain english</i>*.</p>
        </header>

        <article class="spaced">
           <h2><a href="#magic-time-machine" id="magic-time-machine" class="permalinked">Oh shit, I did something terribly wrong, please tell me git has a magic time machine!?!</a></h2>
           <pre class="language-git"><code class="language-git">
            git reflog
            # you will see a list of every thing you've done in git, across all branches!
            # each one has an index HEAD@{index}
            # find the one before you broke everything
            git reset HEAD@{index}
            # magic time machine
           </code></pre>
           <p>You can use this to get back stuff you accidentally deleted, or just to remove some stuff you tried that broke the repo, or to recover after a bad merge, or just to go back to a time when things actually worked. I use <code>reflog</code> A LOT. Mega hat tip to the many many many many many people who suggested adding it!</p>
        </article>

        <article class="spaced">
            <h2><a href="#change-last-commit" id="change-last-commit" class="permalinked">Oh shit, I committed and immediately realized I need to make one small change!</a></h2>
            <pre class="language-git"><code class="language-git">
                # make your change
                git add . # or add individual files
                git commit --amend
                # follow prompts to change or keep the commit message
                # now your last commit contains that change!
            </code></pre>
            <p>This usually happens to me if I commit, then run tests/linters... and FML, I didn't put a space after the equals sign. You could also make the change as a new commit and then do <code>rebase -i</code> in order to squash them both together, but this is about a million times faster.</p>
        </article>

        <article class="spaced">
            <h2><a href="#change-last-commit-message" id="change-last-commit-message" class="permalinked">Oh shit, I need to change the message on my last commit!</a></h2>
            <pre class="language-git"><code class="language-git">
            	git commit --amend
            	# follow prompts to change the commit message
            </code></pre>
            <p>Stupid commit message formatting requirements.</p>
        </article>

        <article class="spaced">
            <h2><a href="#accidental-commit-master" id="accidental-commit-master" class="permalinked">Oh shit, I accidentally committed something to master that should have been on a brand new branch!</a></h2>
            <pre class="language-git"><code class="language-git">
                # create a new branch from the current state of master
                git branch some-new-branch-name
                # remove the commit from the master branch
                git reset HEAD~ --hard
                git checkout some-new-branch-name
                # your commit lives in this branch now :)
            </code></pre>
            <p>Note: this doesn't work if you've already pushed to origin, and if you tried other things first, you might need to <code>git reset HEAD@{number}</code> instead of <code>HEAD~</code>. Infinite sadness. Also, many many many people suggested an awesome way to make this shorter that I didn't know myself. Thank you all!</p>
        </article>

        <article class="spaced">
            <h2><a href="#accidental-commit-wrong-branch" id="accidental-commit-wrong-branch" class="permalinked">Oh shit, I accidentally committed to the wrong branch!</a></h2>
            <pre class="language-git"><code class="language-git">
                # undo the last commit, but leave the changes available
                git reset HEAD~ --soft
                git stash
                # move to the correct branch
                git checkout name-of-the-correct-branch
                git stash pop
                git add . # or add individual files
                git commit -m "your message here"
                # now your changes are on the correct branch
            </code></pre>
            <p>A lot of people have suggested using cherry-pick for this situation too, so take your pick on whatever one makes the most sense to you!</p>
            <pre class="language-git"><code class="language-git">
                git checkout name-of-the-correct-branch
                # grab the last commit to master
                git cherry-pick master
                # delete it from master
                git checkout master
                git reset HEAD~ --hard
            </code></pre>
        </article>

        <article class="spaced">
            <h2><a href="#dude-wheres-my-diff" id="dude-wheres-my-diff" class="permalinked">Oh shit, I tried to run a diff but nothing happened?!</a></h2>
            <pre class="language-git"><code class="language-git">git diff --staged</code></pre>
            <p>Git won't do a diff of files that have been <code>add</code>-ed to your staging area without this flag. File under ¯\_(ツ)_/¯ (yes, this is a feature, not a bug, but it's baffling and non-obvious the first time it happens to you!)<p>
        </article>

        <article class="spaced">
            <h2><a href="#fuck-this-noise" id="fuck-this-noise" class="permalinked">Fuck this noise, I give up.</a></h2>
            <pre class="language-git"><code class="language-git">
                cd ..
                sudo rm -r fucking-git-repo-dir
                git clone https://some.github.url/fucking-git-repo-dir.git
                cd fucking-git-repo-dir
            </code></pre>
            <p>Thanks to <a href="https://twitter.com/viaz66">@viaz66</a> for this one.</p>
        </article>

        <footer class="spaced centered">
        	<p class="top-lined bottom-lined"><small>*Disclaimer: I am not, nor do I even remotely claim to be, an expert at git. This site is not intended to be an exhaustive reference, nor is it a beginner's tutorial. And yes, there are other ways to do these same things with more theoretical purity or whatever, but I've come to these steps through trial and error and lots of swearing and table flipping, and I had this crazy idea to share them with a healthy dose of levity and profanity. Take it or leave it as you will! Also, the response has been so overwhelming, I haven't had a chance to sort through submission emails & tweets. SOON.</small></p>
        	
        	
 		<div class="bottom-lined">
 			<small class="flattr-note">Did this site help you "git" out of a mess? Why not donate a little to help cover hosting costs? THANK YOU! </small>
 			<script id='fb734q0'>(function(i){var f,s=document.getElementById(i);f=document.createElement('iframe');f.src='//button.flattr.com/view/?fid=lgxr5o&button=compact&url=http%3A%2F%2Fohshitgit.com';f.title='Flattr';f.height=20;f.width=110;f.style.borderWidth=0;s.parentNode.insertBefore(f,s);})('fb734q0');</script>
 		</div>
 		
 		<p><small>What's your "Oh shit, git" moment? Share them with me:<br/>Katie at ohshitgit.com or <a href="https://twitter.com/ohshitgit">@ohshitgit</a>. (I'm also <a href="https://twitter.com/ksylor">@ksylor</a>, but that's mostly for stupid jokes about my kids)</small></p>
        </footer>
        <script src="/prism.js"></script>
    </body>
</html>